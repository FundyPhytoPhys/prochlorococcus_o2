---
title: "Import_Map"
author:
- Sylwia Sliwinska-Wilczewska
- Douglas A. Campbell
date: "`r format(Sys.Date())`"
output:
bookdown::html_document2:
    code_folding: show
    keep_md: yes
    toc: TRUE
    toc_float: TRUE
    toc_depth: 6
    fig_caption: yes
bibliography: BalticPhotoperiod.bib
csl: plos-one.csl
editor_options: 
  markdown: 
    wrap: 72
---

# Set Chunk Options

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
knitr::opts_chunk$set(fig.path='Figs/')
```

# Introduction


# Load Libraries and set Project Variables

```{r load libraries} 
library(tidyverse)
#library(lubridate)
#library(stringr)
library(broom)
#library(knitr)
library(OneR)
library(zoo)
library(ggpubr)
library(data.table)
# library(googledrive)
# library(googlesheets4)
library(ggspectra)
library(photobiologyWavebands)
library(photobiology)
library(ggforce) #ellipse
library("patchwork") # merging plots

```

```{r set project variables}
Project <- "prochlorococcus_O2"

FigPath <- file.path("..", "Output", "Figures")
#FigRdsPath <- file.path("..", "Output", "FiguresRds")
#TableRdsPath <- file.path("..", "Output", "TablesRDS")
```

----------------------------------------Create map ----------------------------------------------

# Create map
https://www.geeksforgeeks.org/how-to-make-world-map-with-ggplot2-in-r/

```{r}
world_coordinates <- map_data("world") 
world_coordinates$facetsTropicFull <- 'All~year~~~~~~~~~~~~~~Oxygen:~Full'
world_coordinates$facetsSpringFull <- '21.03/21.09~~~~~~~~~~~~~~Oxygen:~Full'
world_coordinates$facetsSummerFull <- '21.06~~~~~~~~~~~~~~Oxygen:~Full'
world_coordinates$facetsWinterFull <- '21.12~~~~~~~~~~~~~~Oxygen:~Full'

world_coordinates$facetsTropicOMZ <- 'All~year~~~~~~~~~~~~~~Oxygen:~OMZ'
world_coordinates$facetsSpringOMZ <- '21.03/21.09~~~~~~~~~~~~~~Oxygen:~OMZ'
world_coordinates$facetsSummerOMZ <- '21.06~~~~~~~~~~~~~~Oxygen:~OMZ'
world_coordinates$facetsWinterOMZ <- '21.12~~~~~~~~~~~~~~Oxygen:~OMZ'


world_coordinates$facetsPresent <- 'Present'
world_coordinates$facetsFuture <- 'Future~scenario'
```


```{r create GrowthCurve plot, fig.height = 4, fig.width = 6, warning = FALSE}
data_textA <- data.frame(label = c('A'))

d=data.frame(x1=c(-Inf), x2=c(Inf), y1=c(35), y2=c(55))
d2=data.frame(x1=c(-Inf), x2=c(Inf), y1=c(-35), y2=c(-55))
d3=data.frame(x1=c(-Inf), x2=c(Inf), y1=c(-Inf), y2=c(Inf))
d4=data.frame(x1=c(-Inf), x2=c(Inf), y1=c(-15), y2=c(15))
d5=data.frame(x1=c(-Inf), x2=c(Inf), y1=c(-40), y2=c(40))

data_textTropicFull <- data.frame(label = c('All~year'))
data_textTropicFull2 <- data.frame(label = c('12~h'))
data_textTropicFull3 <- data.frame(label = c('11/7~h'))

TropicFull<-ggplot() + 
  geom_rect(data=d3, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill = "lightskyblue1", color="lightskyblue3", alpha=0.5) +
  geom_rect(data=d4, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill = "khaki1", color="khaki2", alpha=0.8) +
  geom_hline(yintercept = 40, fill = "transparent", color="olivedrab3", linetype = "dashed", alpha=1, size = 1) +
  geom_hline(yintercept = -40, fill = "transparent", color="olivedrab3", linetype = "dashed", alpha=1, size = 1) +
  geom_map(data = world_coordinates, map = world_coordinates, aes(long, lat, map_id = region), color = "white", fill = "gray50", size = 0.2) +

  geom_text(data=data_textTropicFull, aes(x=0, y=110, label=label), size=4.5, parse=TRUE) +
  geom_text(data=data_textTropicFull2, aes(x=-180, y=0, label=label), size=3.5, parse=TRUE) +
  geom_text(data=data_textTropicFull3, aes(x=180, y=0, label=label), size=3.5, parse=TRUE) +
  scale_y_continuous(breaks=seq(-90, 90, by = 45)) +
  coord_cartesian(ylim = c(-90, 120)) +
  labs(y = "Latitude", x = "Longitude") +
  ggh4x::facet_nested(rows = vars(facetsPresent), labeller = label_parsed, switch = "y") +
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(),
        strip.placement = "outside",
        strip.switch.pad.grid = unit(1, "cm"),
        axis.text = element_text(size=14),
        axis.title = element_text(size=14),
        strip.background = element_rect(fill="white"),
        strip.text = element_text(size=18),
        axis.title.y = element_text(vjust = -15),
        #axis.title.x = element_text(margin=margin(t=10)),
        axis.title.x = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        legend.background = element_rect(fill="transparent"),
        legend.position = c(0.12,0.76),
        legend.key.height= unit(0.005, 'cm'),
        legend.spacing.x = unit(0.01, 'cm'),
        legend.text = element_text(size=14))
TropicFull

data_textWinterFull <- data.frame(label = c('21.12'))
data_textWinterFull2 <- data.frame(label = c('8~h'))
data_textWinterFull3 <- data.frame(label = c('16~h'))
data_textWinterFull4 <- data.frame(label = c('8/4~h'))
data_textWinterFull5 <- data.frame(label = c('15/10~h'))

WinterFull<-ggplot() + 
  geom_rect(data=d3, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill = "lightskyblue1", color="lightskyblue3", alpha=0.5) +
  geom_rect(data=d, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill = "khaki1", color="khaki2", alpha=0.8) +
  geom_rect(data=d2, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill = "khaki1", color="khaki2", alpha=0.8) +
    geom_rect(data=d4, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill = "khaki1", color="khaki2", alpha=0.8) +
  geom_hline(yintercept = 40, fill = "transparent", color="olivedrab3", linetype = "dashed", alpha=1, size = 1) +
  geom_hline(yintercept = -40, fill = "transparent", color="olivedrab3", linetype = "dashed", alpha=1, size = 1) +
  geom_map(data = world_coordinates, map = world_coordinates, aes(long, lat, map_id = region), color = "white", fill = "gray50", size = 0.2) +
  geom_text(data=data_textWinterFull, aes(x=0, y=110, label=label), size=4.5, parse=TRUE) +
    geom_text(data=data_textWinterFull2, aes(x=-180, y=50, label=label), size=3.5, parse=TRUE) +
    geom_text(data=data_textWinterFull3, aes(x=-180, y=-50, label=label), size=3.5, parse=TRUE) +
    geom_text(data=data_textWinterFull4, aes(x=180, y=50, label=label), size=3.5, parse=TRUE) +
    geom_text(data=data_textWinterFull5, aes(x=180, y=-50, label=label), size=3.5, parse=TRUE) +
    geom_text(data=data_textTropicFull2, aes(x=-180, y=0, label=label), size=3.5, parse=TRUE) +
    geom_text(data=data_textTropicFull3, aes(x=180, y=0, label=label), size=3.5, parse=TRUE) +
  scale_y_continuous(breaks=seq(-90, 90, by = 45)) +
  coord_cartesian(ylim = c(-90, 120)) +
  labs(y = "Latitude", x = "Longitude") +
  ggh4x::facet_nested(rows = vars(facetsFuture), labeller = label_parsed, switch = "y") +
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(),
        strip.placement = "outside",
        strip.switch.pad.grid = unit(1, "cm"),
        axis.text = element_text(size=14),
        axis.title = element_text(size=14),
        strip.background = element_rect(fill="white"),
        strip.text = element_text(size=18),
        axis.title.y = element_text(vjust = -15),
        #axis.title.x = element_text(margin=margin(t=10)),
        axis.title.x = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        legend.background = element_rect(fill="transparent"),
        legend.position = c(0.12,0.76),
        legend.key.height= unit(0.005, 'cm'),
        legend.spacing.x = unit(0.01, 'cm'),
        legend.text = element_text(size=14))
WinterFull


data_textSpringFull <- data.frame(label = c('21.03/21.09'))
data_textSpringFull2 <- data.frame(label = c('12~h'))
data_textSpringFull3 <- data.frame(label = c('12~h'))

data_textSpringFull4 <- data.frame(label = c('11/6~h'))
data_textSpringFull5 <- data.frame(label = c('11/6~h'))

SpringFull<-ggplot() + 
  geom_rect(data=d3, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill = "lightskyblue1", color="lightskyblue3", alpha=0.5) +
  geom_rect(data=d, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill = "khaki1", color="khaki2", alpha=0.8) +
  geom_rect(data=d2, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill = "khaki1", color="khaki2", alpha=0.8) +
  geom_rect(data=d4, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill = "khaki1", color="khaki2", alpha=0.8) +
  geom_hline(yintercept = 40, fill = "transparent", color="olivedrab3", linetype = "dashed", alpha=1, size = 1) +
  geom_hline(yintercept = -40, fill = "transparent", color="olivedrab3", linetype = "dashed", alpha=1, size = 1) +
  geom_map(data = world_coordinates, map = world_coordinates, aes(long, lat, map_id = region), color = "white", fill = "gray50", size = 0.2) +
  geom_text(data=data_textSpringFull, aes(x=0, y=110, label=label), size=4.5, parse=TRUE) +
    geom_text(data=data_textSpringFull2, aes(x=-180, y=50, label=label), size=3.5, parse=TRUE) +
    geom_text(data=data_textSpringFull3, aes(x=-180, y=-50, label=label), size=3.5, parse=TRUE) +
    geom_text(data=data_textSpringFull4, aes(x=180, y=50, label=label), size=3.5, parse=TRUE) +
    geom_text(data=data_textSpringFull5, aes(x=180, y=-50, label=label), size=3.5, parse=TRUE) +
    geom_text(data=data_textTropicFull2, aes(x=-180, y=0, label=label), size=3.5, parse=TRUE) +
    geom_text(data=data_textTropicFull3, aes(x=180, y=0, label=label), size=3.5, parse=TRUE) +
  
  scale_y_continuous(breaks=seq(-90, 90, by = 45)) +
  coord_cartesian(ylim = c(-90, 120)) +
  labs(y = "Latitude", x = "Longitude") +
  ggh4x::facet_nested(rows = vars(facetsFuture), labeller = label_parsed, switch = "y") +
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(),
        strip.placement = "outside",
        strip.switch.pad.grid = unit(1, "cm"),
        axis.text = element_text(size=14),
        axis.title = element_text(size=14),
        strip.background = element_rect(fill="white"),
        strip.text = element_text(size=18),
        axis.title.y = element_text(vjust = -15),
        #axis.title.x = element_text(margin=margin(t=10)),
        axis.title.x = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        legend.background = element_rect(fill="transparent"),
        legend.position = c(0.12,0.76),
        legend.key.height= unit(0.005, 'cm'),
        legend.spacing.x = unit(0.01, 'cm'),
        legend.text = element_text(size=14))
SpringFull

data_textSummerFull <- data.frame(label = c('21.06'))
data_textSummerFull2 <- data.frame(label = c('16~h'))
data_textSummerFull3 <- data.frame(label = c('8~h'))
data_textSummerFull4 <- data.frame(label = c('15/10~h'))
data_textSummerFull5 <- data.frame(label = c('8/4~h'))
SummerFull<-ggplot() + 
  geom_rect(data=d3, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill = "lightskyblue1", color="lightskyblue3", alpha=0.5) +
  geom_rect(data=d, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill = "khaki1", color="khaki2", alpha=0.8) +
  geom_rect(data=d2, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill = "khaki1", color="khaki2", alpha=0.8) +
    geom_rect(data=d4, mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill = "khaki1", color="khaki2", alpha=0.8) +
  geom_hline(yintercept = 40, fill = "transparent", color="olivedrab3", linetype = "dashed", alpha=1, size = 1) +
  geom_hline(yintercept = -40, fill = "transparent", color="olivedrab3", linetype = "dashed", alpha=1, size = 1) +
  geom_map(data = world_coordinates, map = world_coordinates, aes(long, lat, map_id = region), color = "white", fill = "gray50", size = 0.2) +
  geom_text(data=data_textSummerFull, aes(x=0, y=110, label=label), size=4.5, parse=TRUE) +
    geom_text(data=data_textSummerFull2, aes(x=-180, y=50, label=label), size=3.5, parse=TRUE) +
    geom_text(data=data_textSummerFull3, aes(x=-180, y=-50, label=label), size=3.5, parse=TRUE) +
    geom_text(data=data_textSummerFull4, aes(x=180, y=50, label=label), size=3.5, parse=TRUE) +
    geom_text(data=data_textSummerFull5, aes(x=180, y=-50, label=label), size=3.5, parse=TRUE) +
      geom_text(data=data_textTropicFull2, aes(x=-180, y=0, label=label), size=3.5, parse=TRUE) +
      geom_text(data=data_textTropicFull3, aes(x=180, y=0, label=label), size=3.5, parse=TRUE) +
  
  scale_y_continuous(breaks=seq(-90, 90, by = 45)) +
  coord_cartesian(ylim = c(-90, 120)) +
  labs(y = "Latitude", x = "Longitude") +
  ggh4x::facet_nested(rows = vars(facetsFuture), labeller = label_parsed, switch = "y") +
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(),
        strip.placement = "outside",
        strip.switch.pad.grid = unit(1, "cm"),
        axis.text = element_text(size=14),
        axis.title = element_text(size=14),
        strip.background = element_rect(fill="white"),
        strip.text = element_text(size=18),
        axis.title.y = element_text(vjust = -15),
        #axis.title.x = element_text(margin=margin(t=10)),
        axis.title.x = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        legend.background = element_rect(fill="transparent"),
        legend.position = c(0.12,0.76),
        legend.key.height= unit(0.005, 'cm'),
        legend.spacing.x = unit(0.01, 'cm'),
        legend.text = element_text(size=14))
SummerFull



```


```{r, warning = FALSE, fig.height = 12, fig.width = 6}
Full<- (TropicFull/WinterFull/SpringFull/SummerFull)
Full                         
```

https://sape.inf.usi.ch/quick-reference/ggplot2/geom_polygon


```{r, warning = FALSE, fig.height = 12, fig.width = 6}
# OMZRainbow<- (TropicOMZRainbow/SpringOMZRainbow/SummerOMZRainbow/WinterOMZRainbow)
# OMZRainbow                         
```


```{r, warning = FALSE, fig.height = 16, fig.width = 22}
# MapCombo<-((TropicFull+TropicFullRainbow)+(TropicOMZ+TropicOMZRainbow))/((SpringFull+SpringFullRainbow)+(SpringOMZ+SpringOMZRainbow))/((SummerFull+SummerFullRainbow)+(SummerOMZ+SummerOMZRainbow))/((WinterFull+WinterFullRainbow)+(WinterOMZ+WinterOMZRainbow))
# MapCombo                          
```

https://sape.inf.usi.ch/quick-reference/ggplot2/geom_polygon
```{r}
world_coordinatesRainbow <- map_data("world")
world_coordinatesRainbow$nm <- c(400, 700)

data_text1 <- data.frame(label = c('Near~surface~(180~µE~","~8~h):~Clade~HLI'))
data_text2 <- data.frame(label = c('Near~surface~(180~µE~","~11~h):~Clade~HLI'))
data_text3 <- data.frame(label = c('Near~surface~(180~µE~","~15~h):~Clade~HLI'))

data_text4 <- data.frame(label = c('Deep~(30~µE~","~4~h):~Clade~LLIV'))
data_text5 <- data.frame(label = c('Deep~(30~µE~","~6~h):~Clades~HLI~","~LLII/III~","~LLIV'))
data_text6 <- data.frame(label = c('Deep~(30~µE~","~7~h):~Clades~HLI~","~LLII/III~","~LLIV'))
data_text7 <- data.frame(label = c('Deep~(30~µE~","~10~h):~Clades~HLI~","~LLII/III~","~LLIV'))


d=data.frame(x=c(400,700,700), y=c(100,100,200), t=c('a', 'a', 'a'), r=c(1,2,3))
RainbowComboFull<-ggplot() +
  stat_wl_strip(aes(x = nm), ymin = 100, ymax = 200, alpha = 0.5, world_coordinatesRainbow) +
  scale_fill_identity() +
  geom_polygon(data=d, mapping=aes(x=x, y=y, group=t), fill = "white", show.legend = F) +
  geom_ellipse(aes(x0 = 555, y0 = 143, a = 164, b = 28, angle = pi / 10), fill = "white", colour = "white") +
  coord_fixed() +
  scale_y_continuous(breaks=seq(100, 200, by = 50)) +
  coord_cartesian(ylim = c(80, 220)) +
  geom_text(data=data_text1, aes(x=510, y=215, label=label), size=4.5, parse=TRUE) +
  geom_text(data=data_text2, aes(x=510, y=210, label=label), size=4.5, parse=TRUE) +
  geom_text(data=data_text3, aes(x=510, y=205, label=label), size=4.5, parse=TRUE) +
  
  geom_text(data=data_text4, aes(x=530, y=90, label=label), size=4.5, parse=TRUE) +
  geom_text(data=data_text5, aes(x=530, y=85, label=label), size=4.5, parse=TRUE) + 
  geom_text(data=data_text6, aes(x=530, y=80, label=label), size=4.5, parse=TRUE) +
  geom_text(data=data_text7, aes(x=530, y=75, label=label), size=4.5, parse=TRUE) +
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        strip.background = element_rect(fill="white"),
        strip.text = element_text(size=14),
        legend.background = element_rect(fill="transparent"),
        legend.position = c(0.12,0.76),
        legend.text = element_text(size=14))
RainbowComboFull

```
```{r}
world_coordinatesRainbow <- map_data("world")
world_coordinatesRainbow$nm <- c(400, 700)

data_text1d <- data.frame(label = c('Near~surface~(180~µE~","~8~h):~Clades~HLI~","~LLII/III~","~LLIV'))
data_text2d <- data.frame(label = c('Near~surface~(180~µE~","~11~h):~Clades~HLI~","~LLIV'))
data_text3d <- data.frame(label = c('Near~surface~(180~µE~","~15~h):~Clades~HLI~","~LLIV'))

data_text4d <- data.frame(label = c('Deep~(30~µE~","~4~h):~Clades~LLII/III~","~LLIV'))
data_text5d <- data.frame(label = c('Deep~(30~µE~","~6~h):~Clades~LLII/III~","~LLIV'))
data_text6d <- data.frame(label = c('Deep~(30~µE~","~7~h):~Clades~LLII/III~","~LLIV'))
data_text7d <- data.frame(label = c('Deep~(30~µE~","~10~h):~Clades~HLI~","~LLII/III~","~LLIV'))


d=data.frame(x=c(400,700,700), y=c(100,100,200), t=c('a', 'a', 'a'), r=c(1,2,3))
RainbowComboOMZ<-ggplot() +
  stat_wl_strip(aes(x = nm), ymin = 100, ymax = 200, alpha = 0.5, world_coordinatesRainbow) +
  scale_fill_identity() +
  geom_polygon(data=d, mapping=aes(x=x, y=y, group=t), fill = "white", show.legend = F) +
  geom_ellipse(aes(x0 = 555, y0 = 143, a = 164, b = 28, angle = pi / 10), fill = "white", colour = "white") +
  coord_fixed() +
  scale_y_continuous(breaks=seq(100, 200, by = 50)) +
  coord_cartesian(ylim = c(80, 220)) +
  geom_text(data=data_text1d, aes(x=510, y=215, label=label), size=4.5, parse=TRUE) +
  geom_text(data=data_text2d, aes(x=510, y=210, label=label), size=4.5, parse=TRUE) +
  geom_text(data=data_text3d, aes(x=510, y=205, label=label), size=4.5, parse=TRUE) +
  
  geom_text(data=data_text4d, aes(x=530, y=90, label=label), size=4.5, parse=TRUE) +
  geom_text(data=data_text5d, aes(x=530, y=85, label=label), size=4.5, parse=TRUE) + 
  geom_text(data=data_text6d, aes(x=530, y=80, label=label), size=4.5, parse=TRUE) +
  geom_text(data=data_text7d, aes(x=530, y=75, label=label), size=4.5, parse=TRUE) +
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        strip.background = element_rect(fill="white"),
        strip.text = element_text(size=14),
        legend.background = element_rect(fill="transparent"),
        legend.position = c(0.12,0.76),
        legend.text = element_text(size=14))
RainbowComboOMZ

```




```{r, warning = FALSE, fig.height = 16, fig.width = 24}
library(ggpubr)
ss<-ggarrange(RainbowComboFull, RainbowComboOMZ,
          ncol = 1, nrow = 2)
ss


zzz<- ggarrange(TropicFull, WinterFull, SpringFull, SummerFull, 
          ncol = 1, nrow = 4)
zzz



ggarrange(zzz, ss,
          ncol = 2, nrow = 1)

```


```{r save plot}
ggsave(file = file.path(FigPath, paste("MapComboPro_30",".png",sep = "")), height=16, width= 24,  dpi = 300, limitsize = TRUE)
```


------------------------------------------------------------------------------------------------------------------------


# Save rds for further analysis

```{r save rds}
# saveRDS(object = CultureCatalog, file = file.path("..", "Data", "ImportedData", "ImportedMetaData", "CultureCatalog.Rds"), compress = "xz")
```

https://ggforce.data-imaginist.com/reference/geom_ellipse.html
elipse

```{r}

ggplot() +
  geom_ellipse(aes(x0 = 550, y0 = 150, a = 150, b = 50, angle = pi / 4)) +
  coord_fixed()
```


```{r}
# d=data.frame(x=c(400,700,700), y=c(100,100,200), t=c('a', 'a', 'a'), r=c(1,2,3))
# ggplot() +
#   stat_wl_strip(aes(x = nm), ymin = 100, ymax = 200, alpha = 0.5, world_coordinatesRainbow) +
#   scale_fill_identity() +
#   geom_polygon(data=d, mapping=aes(x=x, y=y, group=t), fill = "white", show.legend = F) +
#   scale_y_continuous(breaks=seq(100, 200, by = 50)) +
#   coord_cartesian(ylim = c(80, 220)) +
#   theme_bw() +
#   geom_ellipse(aes(x0 = 555, y0 = 143, a = 164, b = 28, angle = pi / 10), fill = "white", colour = "white") +
#   coord_fixed()
```

```{r}
# library(ggthemes)
# library(mapproj)
# world_map = map_data("world") %>% 
#   filter(! long > 180)
# 
# countries = world_map %>% 
#   distinct(region) %>% 
#   rowid_to_column()
# 
# countries %>% 
#   ggplot(aes(map_id = region), fill = "midnightblue") +
#   geom_map(map = world_map) +
#   expand_limits(x = world_map$long, y = world_map$lat) +
#   coord_map("moll") 
#   #theme_map()
# 
# 
# 
# 
# world_map = map_data("world") %>% 
#   filter(! long > 180)
#   
# distinct(world_map, region) %>% 
#   ggplot(aes(map_id = region), fill = "midnightblue") +
#   geom_map(map = world_map) +
#   expand_limits(x = world_map$long, y = world_map$lat) +
#   coord_map("moll") 
#   #coord_equal() 
```




